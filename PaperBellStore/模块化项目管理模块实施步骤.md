# æ¨¡å—åŒ–é¡¹ç›®ç®¡ç†æ¨¡å—å®æ–½æ­¥éª¤

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•åˆ›å»ºä¸€ä¸ª**ç‹¬ç«‹çš„æ¨¡å—é¡¹ç›®**æ¥å®ç°é¡¹ç›®ç®¡ç†åŠŸèƒ½ï¼Œ**æ— éœ€ä¿®æ”¹**ç°æœ‰çš„åŸºç¡€é¡¹ç›®ä»£ç ã€‚

## ABP å®˜æ–¹æ¨¡å—è®¾è®¡ç†å¿µ

- é¢†åŸŸã€å¥‘çº¦ã€åº”ç”¨ï¼ˆDomain/Shared/Contracts/Applicationï¼‰å±‚è¦é¿å…å¾ªç¯ä¾èµ–ï¼›
  EFCore å±‚çš„èŒè´£æ˜¯â€œæ‰©å±•ä¸è£…é…ä¸»é¡¹ç›®çš„æ•°æ®åº“â€â€”â€”å®ƒæ­£æ˜¯ç”¨äºâ€œèšåˆâ€ä¸šåŠ¡å­æ¨¡å—çš„ä»“å‚¨å’Œå®ä½“çš„ï¼Œæ‰€ä»¥å¯ä»¥ï¼ˆå¿…é¡»ï¼‰å¼•ç”¨ä¸»é¡¹ç›®çš„ EFCoreï¼Œä½œä¸ºæ‰©å±•è€…ï¼›
  è¿™æ ·ä½ å¯ä»¥åœ¨ ProjectManagement.EntityFrameworkCore é€šè¿‡ options.AddRepository<>ã€builder.Entity<>ã€éƒ¨åˆ†è¿ç§»é…ç½®ç­‰ï¼Œç›´æ¥è£…é…ä¸»é¡¹ç›®çš„ DbContextã€‚

## åªè¦ EFCore å±‚ä¸åå‘ä¾èµ–å­ä¸šåŠ¡ EFCoreï¼Œå°±æ°¸è¿œä¸ä¼šæ„æˆâ€œç¼–è¯‘ç¯å¼•ç”¨â€ï¼

- ä¸»é¡¹ç›® PaperBellStore.EntityFrameworkCore æœ€ç»ˆèšåˆæ‰€æœ‰æ¨¡å—ï¼ˆå³é¡¹ç›®å¼•ç”¨å„ modules//EntityFrameworkCoreï¼‰ï¼Œç„¶åç”±ä¸»é¡¹ç›®è¿ç§»å’Œè¿è¡Œç»Ÿä¸€è°ƒåº¦æ•°æ®åº“ã€‚
  å­æ¨¡å—çš„ EntityFrameworkCore åªä¾èµ–ä¸»é¡¹ç›®ï¼ˆæˆ–è€… contractsã€domainã€sharedï¼‰ï¼Œä¸ä¼šè·³å‡ºè‡ªå·±æ¨¡å—çš„æ§åˆ¶ï¼Œä¸ä¼šæœ‰ç¯è·¯

## ğŸ“‹ æ¶æ„ä¼˜åŠ¿

åˆ›å»ºç‹¬ç«‹æ¨¡å—çš„ä¼˜åŠ¿ï¼š

- âœ… **é›¶ä¾µå…¥**ï¼šä¸ä¿®æ”¹åŸºç¡€é¡¹ç›®çš„ä»£ç é€»è¾‘
- âœ… **å¯ç»´æŠ¤**ï¼šåŠŸèƒ½æ¨¡å—ç‹¬ç«‹å¼€å‘å’Œç»´æŠ¤
- âœ… **å¯å¤ç”¨**ï¼šæ¨¡å—å¯åœ¨å…¶ä»–é¡¹ç›®ä¸­å¤ç”¨
- âœ… **æ˜“æµ‹è¯•**ï¼šæ¨¡å—ç‹¬ç«‹æµ‹è¯•
- âœ… **æ˜“å‡çº§**ï¼šåŸºç¡€é¡¹ç›®å‡çº§ä¸å½±å“æ¨¡å—

---

## ğŸ—ï¸ æ¨¡å—é¡¹ç›®ç»“æ„

### ç›®å½•ç»“æ„æ–¹æ¡ˆé€‰æ‹©

#### æ–¹æ¡ˆ ï¼šæ¨¡å—åœ¨ç‹¬ç«‹çš„ `modules` ç›®å½•ä¸‹ï¼ˆâ­ æ¨èï¼‰

```
PaperBellStore/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ PaperBellStore.Domain/
â”‚   â”œâ”€â”€ PaperBellStore.Domain.Shared/
â”‚   â”œâ”€â”€ PaperBellStore.Application/
â”‚   â”œâ”€â”€ PaperBellStore.Application.Contracts/
â”‚   â”œâ”€â”€ PaperBellStore.EntityFrameworkCore/
â”‚   â””â”€â”€ PaperBellStore.Blazor/
â”œâ”€â”€ modules/                                # ç‹¬ç«‹çš„æ¨¡å—ç›®å½•
â”‚   â””â”€â”€ ProjectManagement/
â”‚       â”œâ”€â”€ ProjectManagement.Domain.Shared/
â”‚       â”œâ”€â”€ ProjectManagement.Domain/
â”‚       â”œâ”€â”€ ProjectManagement.Application.Contracts/
â”‚       â”œâ”€â”€ ProjectManagement.Application/
â”‚       â”œâ”€â”€ ProjectManagement.EntityFrameworkCore/
â”‚       â””â”€â”€ ProjectManagement.Blazor/      # ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ test/
```

**æ–¹æ¡ˆ çš„ä¼˜åŠ¿**ï¼š

- âœ… **æ¸…æ™°åˆ†ç¦»** - ä¸»é¡¹ç›®å’Œä¸šåŠ¡æ¨¡å—ä¸€ç›®äº†ç„¶
- âœ… **æ˜“äºç®¡ç†** - æ‰€æœ‰å®šåˆ¶æ¨¡å—é›†ä¸­åœ¨ä¸€ä¸ªç›®å½•
- âœ… **ä¾¿äºå¤ç”¨** - æ¨¡å—å¯ä»¥ç‹¬ç«‹æ‰“åŒ…æˆ–è¿ç§»
- âœ… **ç¬¦åˆä¼ä¸šå®è·µ** - å¤§å‹é¡¹ç›®å¸¸ç”¨çš„ç»„ç»‡ç»“æ„

---

## ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¨¡å—é¡¹ç›®è§£å†³æ–¹æ¡ˆç»“æ„

### 1.1 åˆ›å»ºç›®å½•ç»“æ„

```bash
# åˆ›å»ºæ¨¡å—æ ¹ç›®å½•
mkdir modules
mkdir modules/ProjectManagement

# åˆ›å»ºæ¨¡å—é¡¹ç›®ç›®å½•
mkdir modules/ProjectManagement/ProjectManagement.Domain.Shared
mkdir modules/ProjectManagement/ProjectManagement.Domain
mkdir modules/ProjectManagement/ProjectManagement.Application.Contracts
mkdir modules/ProjectManagement/ProjectManagement.Application
mkdir modules/ProjectManagement/ProjectManagement.EntityFrameworkCore
mkdir modules/ProjectManagement/ProjectManagement.Blazor  # ï¼ˆå¯é€‰ï¼Œæ–¹æ¡ˆAä¸éœ€è¦ï¼‰
```

### 1.2 åˆ›å»ºé¡¹ç›®æ–‡ä»¶

#### ProjectManagement.Domain.Shared.csproj

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="..\..\..\common.props" />
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    	<PackageReference Include="Microsoft.Extensions.FileProviders.Embedded" Version="9.0.4" />
	  <PackageReference Include="Volo.Abp.Core" Version="9.2.1" />
	<PackageReference Include="Volo.Abp.Localization" Version="9.2.1" />
	<PackageReference Include="Volo.Abp.Localization.Abstractions" Version="9.2.1" />
	<PackageReference Include="Volo.Abp.Validation" Version="9.2.1" />
	<PackageReference Include="Volo.Abp.VirtualFileSystem" Version="9.2.1" />
  </ItemGroup>
</Project>
```

#### ProjectManagement.Domain.csproj

**æ³¨æ„**ï¼šæ ¹æ®ç›®å½•ç»“æ„é€‰æ‹©ï¼Œè°ƒæ•´ç›¸å¯¹è·¯å¾„ï¼š

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼Œæ¨èï¼‰**ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="..\..\..\common.props" />  <!-- æ³¨æ„ï¼šè·¯å¾„å¤šäº†ä¸€å±‚ -->
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\ProjectManagement.Domain.Shared\ProjectManagement.Domain.Shared.csproj" />
  </ItemGroup>
 	<ItemGroup>
		<PackageReference Include="Volo.Abp.Ddd.Domain" Version="9.2.1" />
		<PackageReference Include="Volo.Abp.PermissionManagement.Domain" Version="9.2.1" />
	</ItemGroup>
</Project>
```

#### ProjectManagement.Application.Contracts.csproj

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="..\..\..\common.props" />  <!-- æ³¨æ„ï¼šè·¯å¾„è°ƒæ•´ -->
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\ProjectManagement.Domain.Shared\ProjectManagement.Domain.Shared.csproj" />
  </ItemGroup>
	<ItemGroup>
		<PackageReference Include="Volo.Abp.Ddd.Application.Contracts" Version="9.2.1" />
		<PackageReference Include="Volo.Abp.PermissionManagement.Application.Contracts" Version="9.2.1" />
	</ItemGroup>
</Project>
```

#### ProjectManagement.Application.csproj

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="..\..\..\common.props" />  <!-- æ³¨æ„ï¼šè·¯å¾„è°ƒæ•´ -->
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\ProjectManagement.Domain\ProjectManagement.Domain.csproj" />
    <ProjectReference Include="..\ProjectManagement.Application.Contracts\ProjectManagement.Application.Contracts.csproj" />
  </ItemGroup>
	<ItemGroup>
		<PackageReference Include="Volo.Abp.AutoMapper" Version="9.2.1" />
		<PackageReference Include="Volo.Abp.Ddd.Application" Version="9.2.1" />
		<PackageReference Include="Volo.Abp.Identity.Domain" Version="9.2.1" />
	</ItemGroup>
</Project>
```

#### ProjectManagement.EntityFrameworkCore.csproj

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <Import Project="..\..\..\common.props" />  <!-- æ³¨æ„ï¼šè·¯å¾„è°ƒæ•´ -->
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement</RootNamespace>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\ProjectManagement.Domain\ProjectManagement.Domain.csproj" />
    <ProjectReference Include="..\ProjectManage.Application\ProjectManage.Application.csproj" />
    <ProjectReference Include="..\..\..\src\PaperBellStore.EntityFrameworkCore\PaperBellStore.EntityFrameworkCore.csproj" />  <!-- æ³¨æ„ï¼šè·¯å¾„è°ƒæ•´ -->
  </ItemGroup>
	<ItemGroup>
		<PackageReference Include="System.Linq.Dynamic.Core" Version="1.6.9" />
		<PackageReference Include="Volo.Abp.EntityFrameworkCore" Version="9.2.1" />
		<PackageReference Include="Volo.Abp.EntityFrameworkCore.PostgreSql" Version="9.2.1" />
	</ItemGroup>
</Project>
```

#### ProjectManagement.Blazor.csproj ï¼ˆå¯é€‰ - æ–¹æ¡ˆ B ä½¿ç”¨ï¼‰

**æ³¨æ„**ï¼šåœ¨ ABP æ¨¡å—åŒ–æ¶æ„ä¸­ï¼Œæœ‰ä¸¤ç§å¤„ç† UI å±‚çš„æ–¹å¼ï¼š

- **æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰**ï¼šUI å±‚ç›´æ¥æ”¾åœ¨ä¸»é¡¹ç›®ä¸­ï¼Œæ¨¡å—åªæä¾›ä¸šåŠ¡é€»è¾‘å±‚
- **æ–¹æ¡ˆ B**ï¼šåˆ›å»ºç‹¬ç«‹çš„ Blazor é¡¹ç›®ä½œä¸ºç»„ä»¶åº“ï¼Œä½†ä¸å¼•ç”¨ä¸»é¡¹ç›®çš„ Blazor

å¦‚æœæ‚¨é€‰æ‹©æ–¹æ¡ˆ Aï¼Œå¯ä»¥è·³è¿‡æ­¤é¡¹ç›®ã€‚å¦‚æœé€‰æ‹©æ–¹æ¡ˆ Bï¼Œä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š

```xml
<Project Sdk="Microsoft.NET.Sdk.Razor">
  <!-- å¦‚æœé‡‡ç”¨ modules ç›®å½•ç»“æ„ï¼Œè¯·å°†è·¯å¾„æ”¹ä¸º ..\..\..\common.props -->
  <Import Project="..\..\common.props" />
  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <RootNamespace>ProjectManagement.Blazor</RootNamespace>
    <!-- å¦‚æœä½œä¸ºç»„ä»¶åº“ï¼Œå¯ä»¥è®¾ç½® -->
    <!-- <IsPackable>true</IsPackable> -->
  </PropertyGroup>
  <ItemGroup>
    <!-- æ³¨æ„ï¼šä¸å¼•ç”¨ä¸»é¡¹ç›®çš„ Blazor é¡¹ç›®ï¼Œé¿å…å¾ªç¯ä¾èµ– -->
    <ProjectReference Include="..\ProjectManagement.Application\ProjectManagement.Application.csproj" />
    <ProjectReference Include="..\ProjectManagement.Application.Contracts\ProjectManagement.Application.Contracts.csproj" />
    <!-- å¦‚æœéœ€è¦ä¸»é¡¹ç›®çš„æŸäº›ç±»å‹ï¼Œåªå¼•ç”¨å…¶ Domain æˆ– Application å±‚ -->
    <!-- <ProjectReference Include="..\PaperBellStore.Application.Contracts\PaperBellStore.Application.Contracts.csproj" /> -->
  </ItemGroup>
  <ItemGroup>
    <PackageReference Include="Volo.Abp.AspNetCore.Components.Server" Version="9.2.1" />
    <PackageReference Include="MudBlazor" Version="7.24.1" />
  </ItemGroup>
</Project>
```

---

## ç¬¬äºŒæ­¥ï¼šDomain.Shared å±‚

### 2.1 åˆ›å»ºå¸¸é‡

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/ProjectManagementConsts.cs`

```csharp
namespace ProjectManagement;

public static class ProjectManagementConsts
{
    public const string DbTablePrefix = "Pm";
    public const string? DbSchema = null;
}
```

### 2.2 åˆ›å»ºæšä¸¾

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/Projects/ProjectStatus.cs`

```csharp
namespace ProjectManagement.Projects;

public enum ProjectStatus
{
    Planning = 0,
    InProgress = 1,
    OnHold = 2,
    Completed = 3,
    Cancelled = 4
}
```

### 2.3 åˆ›å»ºé¢†åŸŸæ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/ProjectManageDomainSharedModule.cs`

```csharp
namespace ProjectManagement;

 public class ProjectManageDomainSharedModule : AbpModule
 {

     public override void ConfigureServices(ServiceConfigurationContext context)
     {
         Configure<AbpVirtualFileSystemOptions>(options =>
         {
             options.FileSets.AddEmbedded<ProjectManageDomainSharedModule>();
         });

         Configure<AbpLocalizationOptions>(options =>
         {
             options.Resources
                 .Add<ProjectManageResource>("en")
                 .AddBaseTypes(typeof(AbpValidationResource))
                 .AddVirtualJson("/Localization/ProjectManage");

             options.DefaultResourceType=typeof(ProjectManageResource);

             options.Languages.Add(new LanguageInfo("en" , "en" , "English"));
             //options.Languages.Add(new LanguageInfo("en-GB" , "en-GB" , "English (United Kingdom)"));
             options.Languages.Add(new LanguageInfo("zh-Hans" , "zh-Hans" , "ç®€ä½“ä¸­æ–‡"));
             //options.Languages.Add(new LanguageInfo("es" , "es" , "EspaÃ±ol"));
             //options.Languages.Add(new LanguageInfo("ar" , "ar" , "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"));
             //options.Languages.Add(new LanguageInfo("hi" , "hi" , "à¤¹à¤¿à¤¨à¥à¤¦à¥€"));
             //options.Languages.Add(new LanguageInfo("pt-BR" , "pt-BR" , "PortuguÃªs (Brasil)"));
             //options.Languages.Add(new LanguageInfo("fr" , "fr" , "FranÃ§ais"));
             //options.Languages.Add(new LanguageInfo("ru" , "ru" , "Ğ ÑƒÑÑĞºĞ¸Ğ¹"));
             //options.Languages.Add(new LanguageInfo("de-DE" , "de-DE" , "Deutsch (Deuthschland)"));
             //options.Languages.Add(new LanguageInfo("tr" , "tr" , "TÃ¼rkÃ§e"));
             //options.Languages.Add(new LanguageInfo("it" , "it" , "Italiano"));
             //options.Languages.Add(new LanguageInfo("cs" , "cs" , "ÄŒeÅ¡tina"));
             //options.Languages.Add(new LanguageInfo("hu" , "hu" , "Magyar"));
             //options.Languages.Add(new LanguageInfo("ro-RO" , "ro-RO" , "RomÃ¢nÄƒ (RomÃ¢nia)"));
             //options.Languages.Add(new LanguageInfo("sv" , "sv" , "Svenska"));
             //options.Languages.Add(new LanguageInfo("fi" , "fi" , "Suomi"));
             //options.Languages.Add(new LanguageInfo("sk" , "sk" , "SlovenÄina"));
             //options.Languages.Add(new LanguageInfo("is" , "is" , "Ãslenska"));
             //options.Languages.Add(new LanguageInfo("zh-Hant" , "zh-Hant" , "ç¹é«”ä¸­æ–‡"));

         });

         Configure<AbpExceptionLocalizationOptions>(options =>
         {
             options.MapCodeNamespace("ProjectManage" , typeof(ProjectManageResource));
         });
     }
 }

```

### 2.4 åˆ›å»ºæœ¬åœ°åŒ–èµ„æº

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/Localization/ProjectManageResource.cs`

```csharp
namespace ProjectManagement.Localization;

  [LocalizationResourceName("ProjectManage")]
  public class ProjectManageResource
  {

  }
```

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/Localization/ProjectManage/zh-Hans.json` \***\*æ³¨æ„\*\*** : `éœ€è¦é…ç½®å±æ€§ä¸ºåµŒå…¥çš„èµ„æº`

```json
{
  "culture": "zh-Hans",
  "texts": {
    "Permission:ProjectManagement": "é¡¹ç›®ç®¡ç†",
    "Permission:ProjectManagement.Create": "åˆ›å»ºé¡¹ç›®",
    "Permission:ProjectManagement.Edit": "ç¼–è¾‘é¡¹ç›®",
    "Permission:ProjectManagement.Delete": "åˆ é™¤é¡¹ç›®",
    "Permission:ProjectManagement.View": "æŸ¥çœ‹é¡¹ç›®",
    "Menu:ProjectManagement": "é¡¹ç›®ç®¡ç†"
  }
}
```

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/Localization/ProjectManage/en.json` \***\*æ³¨æ„\*\*** : `éœ€è¦é…ç½®å±æ€§ä¸ºåµŒå…¥çš„èµ„æº`

```json
{
  "culture": "en",
  "texts": {
    "Permission:ProjectManagement": "Project Management",
    "Permission:ProjectManagement.Create": "Create Project",
    "Permission:ProjectManagement.Edit": "Edit Project",
    "Permission:ProjectManagement.Delete": "Delete Project",
    "Permission:ProjectManagement.View": "View Project",
    "Menu:ProjectManagement": "Project Management"
  }
}
```

---

## ç¬¬ä¸‰æ­¥ï¼šDomain å±‚

### 3.1 åˆ›å»ºå®ä½“

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain/Projects/Project.cs`

```csharp
using System;
using Volo.Abp.Domain.Entities.Auditing;
using Volo.Abp.MultiTenancy;

namespace ProjectManagement.Projects;

public class Project : FullAuditedAggregateRoot<Guid>, IMultiTenant
{
    public string Name { get; set; }
    public string Description { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime? EndDate { get; set; }
    public ProjectStatus Status { get; set; }
    public Guid? OwnerId { get; set; }
    public Guid? TenantId { get; set; }

    protected Project()
    {
    }

    public Project(Guid id, string name, string description = null)
        : base(id)
    {
        Name = name;
        Description = description;
        Status = ProjectStatus.Planning;
    }
}
```

### 3.2 åˆ›å»ºä»“å‚¨æ¥å£

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain/Projects/IProjectRepository.cs`

```csharp
using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using Volo.Abp.Domain.Repositories;

namespace ProjectManagement.Projects;

public interface IProjectRepository : IRepository<Project, Guid>
{
    Task<List<Project>> GetListAsync(
        string sorting = null,
        int maxResultCount = int.MaxValue,
        int skipCount = 0,
        string filter = null,
        CancellationToken cancellationToken = default);

    Task<long> GetCountAsync(
        string filter = null,
        CancellationToken cancellationToken = default);
}
```

### 3.3 åˆ›å»ºé¢†åŸŸæ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain/ProjectManagementDomainModule.cs`

```csharp
using Microsoft.Extensions.DependencyInjection;
using Volo.Abp.Modularity;
using PaperBellStore;

namespace ProjectManagement;

[DependsOn(
    typeof(ProjectManagementDomainSharedModule),
    typeof(PaperBellStoreDomainModule)
)]
public class ProjectManagementDomainModule : AbpModule
{
    public override void ConfigureServices(ServiceConfigurationContext context)
    {
    }
}
```

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain.Shared/ProjectManagementDomainSharedModule.cs`

```csharp
using Volo.Abp.Modularity;

namespace ProjectManagement;

public class ProjectManagementDomainSharedModule : AbpModule
{
}
```

### 3.4 åˆ›å»ºæƒé™çš„æ•°æ®ç§å­

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Domain/ProjectManageDataSeedContributor.cs`

```csharp
using Volo.Abp.Data;
using Volo.Abp.DependencyInjection;
using Volo.Abp.PermissionManagement;
using Volo.Abp.Uow;


namespace ProjectManage.Domain;

 public class ProjectManageDataSeedContributor : IDataSeedContributor, ITransientDependency
 {
     private readonly IPermissionDataSeeder _permissionDataSeeder;

     public ProjectManageDataSeedContributor(IPermissionDataSeeder permissionDataSeeder)
     {
         _permissionDataSeeder=permissionDataSeeder;
     }

     [UnitOfWork]
     public async Task SeedAsync(DataSeedContext context)
     {
         // é»˜è®¤ç®¡ç†å‘˜è§’è‰²åä¸º "admin"
         var permissions = new[]
         {
             "ProjectManagement.View",
             "ProjectManagement.Create",
             "ProjectManagement.Edit",
             "ProjectManagement.Delete"
         };

         // è§’è‰²æƒé™æä¾›è€…åç§°ï¼ˆRolePermissionValueProvider.ProviderNameï¼‰ï¼Œæ­¤å¤„ç›´æ¥ä½¿ç”¨å¸¸é‡å€¼ "R"
         await _permissionDataSeeder.SeedAsync(
             "R" ,
             "admin" ,
             permissions ,
             context.TenantId
         );
     }
 }

```

---

## ç¬¬å››æ­¥ï¼šApplication.Contracts å±‚

### 4.1 åˆ›å»º DTO

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Projects/ProjectDto.cs`

```csharp
using System;
using Volo.Abp.Application.Dtos;

namespace ProjectManagement.Projects;

public class ProjectDto : FullAuditedEntityDto<Guid>
{
    public string Name { get; set; }
    public string Description { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime? EndDate { get; set; }
    public ProjectStatus Status { get; set; }
    public Guid? OwnerId { get; set; }
    public string OwnerName { get; set; }
}
```

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Projects/CreateUpdateProjectDto.cs`

```csharp
using System;
using System.ComponentModel.DataAnnotations;

namespace ProjectManagement.Projects;

public class CreateUpdateProjectDto
{
    [Required]
    [StringLength(128)]
    public string Name { get; set; }

    [StringLength(2048)]
    public string Description { get; set; }

    [Required]
    public DateTime StartDate { get; set; }

    public DateTime? EndDate { get; set; }

    public ProjectStatus Status { get; set; } = ProjectStatus.Planning;

    public Guid? OwnerId { get; set; }
}
```

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Projects/GetProjectListDto.cs`

```csharp
using Volo.Abp.Application.Dtos;

namespace ProjectManagement.Projects;

public class GetProjectListDto : PagedAndSortedResultRequestDto
{
    public string Filter { get; set; }
    public ProjectStatus? Status { get; set; }
}
```

### 4.2 åˆ›å»ºåº”ç”¨æœåŠ¡æ¥å£

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Projects/IProjectAppService.cs`

```csharp
using System;
using Volo.Abp.Application.Dtos;
using Volo.Abp.Application.Services;

namespace ProjectManagement.Projects;

public interface IProjectAppService :
    ICrudAppService<
        ProjectDto,
        Guid,
        GetProjectListDto,
        CreateUpdateProjectDto,
        CreateUpdateProjectDto>
{
}
```

### 4.3 åˆ›å»ºæƒé™å¸¸é‡

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Permissions/ProjectManagementPermissions.cs`

```csharp
namespace ProjectManagement.Permissions;

public static class ProjectManagementPermissions
{
    public const string GroupName = "ProjectManagement";

    public const string Default = GroupName;
    public const string Create = Default + ".Create";
    public const string Edit = Default + ".Edit";
    public const string Delete = Default + ".Delete";
    public const string View = Default + ".View";
}
```

### 4.4 åˆ›å»ºæƒé™å®šä¹‰æä¾›ç¨‹åº

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/Permissions/ProjectManagementPermissionDefinitionProvider.cs`

```csharp
using Volo.Abp.Authorization.Permissions;
using Volo.Abp.Localization;
using ProjectManagement.Localization;

namespace ProjectManagement.Permissions;

public class ProjectManagementPermissionDefinitionProvider : PermissionDefinitionProvider
{
    public override void Define(IPermissionDefinitionContext context)
    {
        var group = context.AddGroup(
            ProjectManagementPermissions.GroupName,
            L("Permission:ProjectManagement"));

        group.AddPermission(
            ProjectManagementPermissions.Default,
            L("Permission:ProjectManagement"));

        group.AddPermission(
            ProjectManagementPermissions.Create,
            L("Permission:ProjectManagement.Create"));

        group.AddPermission(
            ProjectManagementPermissions.Edit,
            L("Permission:ProjectManagement.Edit"));

        group.AddPermission(
            ProjectManagementPermissions.Delete,
            L("Permission:ProjectManagement.Delete"));

        group.AddPermission(
            ProjectManagementPermissions.View,
            L("Permission:ProjectManagement.View"));
    }

    private static LocalizableString L(string name)
    {
        return LocalizableString.Create<ProjectManageResource>(name);
    }
}
```

### 4.5 åˆ›å»ºåº”ç”¨æœåŠ¡å¥‘çº¦æ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application.Contracts/ProjectManagementApplicationContractsModule.cs`

```csharp
using Volo.Abp.Modularity;
using ProjectManagement;

namespace ProjectManagement;

[DependsOn(
    typeof(ProjectManagementDomainSharedModule)
)]
public class ProjectManagementApplicationContractsModule : AbpModule
{
}
```

---

## ç¬¬äº”æ­¥ï¼šApplication å±‚

### 5.1 åˆ›å»ºåº”ç”¨æœåŠ¡å®ç°

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application/Projects/ProjectAppService.cs`

```csharp
using System;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Authorization;
using ProjectManagement.Permissions;
using ProjectManagement.Projects;
using Volo.Abp.Application.Dtos;
using Volo.Abp.Application.Services;
using Volo.Abp.Domain.Repositories;
using Volo.Abp.Identity;

namespace ProjectManagement.Projects;

[Authorize(ProjectManagementPermissions.Default)]
public class ProjectAppService :
    CrudAppService<
        Project,
        ProjectDto,
        Guid,
        GetProjectListDto,
        CreateUpdateProjectDto,
        CreateUpdateProjectDto>,
    IProjectAppService
{
    private readonly IIdentityUserRepository _userRepository;

    public ProjectAppService(
        IRepository<Project, Guid> repository,
        IIdentityUserRepository userRepository)
        : base(repository)
    {
        _userRepository = userRepository;
        GetPolicyName = ProjectManagementPermissions.View;
        GetListPolicyName = ProjectManagementPermissions.View;
        CreatePolicyName = ProjectManagementPermissions.Create;
        UpdatePolicyName = ProjectManagementPermissions.Edit;
        DeletePolicyName = ProjectManagementPermissions.Delete;
    }

    protected override async Task<ProjectDto> MapToGetOutputDtoAsync(Project entity)
    {
        var dto = await base.MapToGetOutputDtoAsync(entity);

        if (entity.OwnerId.HasValue)
        {
            var owner = await _userRepository.GetAsync(entity.OwnerId.Value);
            dto.OwnerName = owner.UserName;
        }

        return dto;
    }

    protected override async Task<IQueryable<Project>> CreateFilteredQueryAsync(GetProjectListDto input)
    {
        var queryable = await base.CreateFilteredQueryAsync(input);

        if (!string.IsNullOrWhiteSpace(input.Filter))
        {
            queryable = queryable.Where(x =>
                x.Name.Contains(input.Filter) ||
                (x.Description != null && x.Description.Contains(input.Filter)));
        }

        if (input.Status.HasValue)
        {
            queryable = queryable.Where(x => x.Status == input.Status.Value);
        }

        return queryable;
    }
}
```

### 5.2 é…ç½® AutoMapper

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application/ProjectManagementApplicationAutoMapperProfile.cs`

```csharp
using AutoMapper;
using ProjectManagement.Projects;

namespace ProjectManagement;

public class ProjectManagementApplicationAutoMapperProfile : Profile
{
    public ProjectManagementApplicationAutoMapperProfile()
    {
        CreateMap<Project, ProjectDto>();
        CreateMap<CreateUpdateProjectDto, Project>();
    }
}
```

### 5.3 åˆ›å»ºåº”ç”¨æ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Application/ProjectManagementApplicationModule.cs`

```csharp
using Microsoft.Extensions.DependencyInjection;
using Volo.Abp.AutoMapper;
using Volo.Abp.Modularity;
using Volo.Abp.Application;
using Volo.Abp.Identity;
using PaperBellStore;

namespace ProjectManagement;

[DependsOn(
    typeof(ProjectManagementDomainModule),
    typeof(ProjectManagementApplicationContractsModule),
    typeof(AbpApplicationModule),
    typeof(AbpIdentityDomainModule),
    typeof(PaperBellStoreApplicationModule)
)]
public class ProjectManagementApplicationModule : AbpModule
{
    public override void ConfigureServices(ServiceConfigurationContext context)
    {
        Configure<AbpAutoMapperOptions>(options =>
        {
            options.AddMaps<ProjectManagementApplicationModule>();
        });
    }
}
```

---

## ç¬¬å…­æ­¥ï¼šEntityFrameworkCore å±‚

### 6.1 å®ç°ä»“å‚¨

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.EntityFrameworkCore/Projects/ProjectRepository.cs`

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Dynamic.Core;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.EntityFrameworkCore;
using ProjectManagement.Projects;
using Volo.Abp.Domain.Repositories.EntityFrameworkCore;
using Volo.Abp.EntityFrameworkCore;
using PaperBellStore.EntityFrameworkCore;

namespace ProjectManagement.EntityFrameworkCore.Projects;

public class ProjectRepository :
    EfCoreRepository<PaperBellStoreDbContext, Project, Guid>,
    IProjectRepository
{
    public ProjectRepository(
        IDbContextProvider<PaperBellStoreDbContext> dbContextProvider)
        : base(dbContextProvider)
    {
    }

    public async Task<List<Project>> GetListAsync(
        string sorting = null,
        int maxResultCount = int.MaxValue,
        int skipCount = 0,
        string filter = null,
        CancellationToken cancellationToken = default)
    {
        var query = await GetQueryableAsync();

        if (!string.IsNullOrWhiteSpace(filter))
        {
            query = query.Where(x =>
                x.Name.Contains(filter) ||
                (x.Description != null && x.Description.Contains(filter)));
        }

        query = string.IsNullOrWhiteSpace(sorting)
            ? query.OrderByDescending(x => x.CreationTime)
            : query.OrderBy(sorting);

        return await query
            .Skip(skipCount)
            .Take(maxResultCount)
            .ToListAsync(cancellationToken);
    }

    public async Task<long> GetCountAsync(
        string filter = null,
        CancellationToken cancellationToken = default)
    {
        var query = await GetQueryableAsync();

        if (!string.IsNullOrWhiteSpace(filter))
        {
            query = query.Where(x =>
                x.Name.Contains(filter) ||
                (x.Description != null && x.Description.Contains(filter)));
        }

        return await query.LongCountAsync(cancellationToken);
    }
}
```

### 6.2 é…ç½®å®ä½“æ˜ å°„ï¼ˆåœ¨ä¸»é¡¹ç›®çš„ DbContext ä¸­ï¼‰

ç”±äºæˆ‘ä»¬è¦ä½¿ç”¨ä¸»é¡¹ç›®çš„ DbContextï¼Œéœ€è¦åœ¨ä¸»é¡¹ç›®çš„ `PaperBellStoreDbContext` ä¸­æ·»åŠ é¡¹ç›®å®ä½“ï¼š

**ä¿®æ”¹**: `src/PaperBellStore.EntityFrameworkCore/EntityFrameworkCore/PaperBellStoreDbContext.cs`

```csharp
using ProjectManagement.Projects;

public class PaperBellStoreDbContext : AbpDbContext<PaperBellStoreDbContext>
{
    // ... ç°æœ‰ä»£ç  ...

    // æ·»åŠ é¡¹ç›®ç®¡ç†çš„DbSet
    public DbSet<Project> Projects { get; set; }
}
```

åœ¨ `OnModelCreating` æ–¹æ³•ä¸­é…ç½®ï¼š

```csharp
protected override void OnModelCreating(ModelBuilder builder)
{
    base.OnModelCreating(builder);

    // ... ç°æœ‰é…ç½® ...

    // é…ç½®é¡¹ç›®ç®¡ç†å®ä½“
    builder.Entity<Project>(b =>
    {
        b.ToTable(ProjectManagementConsts.DbTablePrefix + "Projects", ProjectManagementConsts.DbSchema);
        b.ConfigureByConvention();

        b.Property(x => x.Name).IsRequired().HasMaxLength(128);
        b.Property(x => x.Description).HasMaxLength(2048);

        b.HasIndex(x => x.Name);
    });
}
```

ä¸ºä½¿ä¸Šè¿°ä»£ç æˆåŠŸç¼–è¯‘ï¼Œéœ€åœ¨ä¸»é¡¹ç›®çš„ EFCore é¡¹ç›®ä¸­æ·»åŠ å¯¹æ¨¡å—é¡¹ç›®çš„å¼•ç”¨ï¼š

**ä¿®æ”¹**: `src/PaperBellStore.EntityFrameworkCore/PaperBellStore.EntityFrameworkCore.csproj`

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼Œæ¨èï¼‰**ï¼š

```xml
<ItemGroup>
  <!-- åŸæœ‰å¼•ç”¨ -->
  <ProjectReference Include="..\PaperBellStore.Domain\PaperBellStore.Domain.csproj" />
  <!-- æ–°å¢ï¼šå¼•ç”¨æ¨¡å—çš„ Domain ä¸ Domain.Sharedï¼ˆç”¨äºå®ä½“ä¸å¸¸é‡ï¼‰ -->
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManagement.Domain\ProjectManagement.Domain.csproj" />
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManagement.Domain.Shared\ProjectManagement.Domain.Shared.csproj" />
</ItemGroup>
```

### 6.3 åˆ›å»º EF Core æ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.EntityFrameworkCore/ProjectManagementEntityFrameworkCoreModule.cs`

```csharp
using Microsoft.Extensions.DependencyInjection;
using Volo.Abp.EntityFrameworkCore;
using Volo.Abp.Modularity;
using ProjectManagement.Projects;
using ProjectManagement.EntityFrameworkCore.Projects;
using PaperBellStore.EntityFrameworkCore;

namespace ProjectManagement.EntityFrameworkCore;

[DependsOn(
    typeof(ProjectManagementDomainModule),
    typeof(ProjectManagementApplicationModule),
    typeof(PaperBellStoreEntityFrameworkCoreModule)
)]
public class ProjectManagementEntityFrameworkCoreModule : AbpModule
{
    public override void ConfigureServices(ServiceConfigurationContext context)
    {
        context.Services.AddAbpDbContext<PaperBellStoreDbContext>(options =>
        {
            // æ·»åŠ é¡¹ç›®ç®¡ç†çš„ä»“å‚¨
            options.AddRepository<Project, ProjectRepository>();
        });
    }
}
```

---

## ç¬¬ä¸ƒæ­¥ï¼šBlazor UI å±‚ï¼ˆå¯é€‰ï¼‰

### 7.1 åˆ›å»º Blazor æ¨¡å—

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Blazor/ProjectManagementBlazorModule.cs`

```csharp
using Microsoft.Extensions.DependencyInjection;
using Volo.Abp.Modularity;
using Volo.Abp.UI.Navigation;
using ProjectManagement.Blazor.Menus;
using ProjectManagement.Application;
using ProjectManagement.Application.Contracts;
// âš ï¸ æ³¨æ„ï¼šå¦‚æœé‡‡ç”¨æ–¹æ¡ˆBï¼Œä¸å¼•ç”¨ PaperBellStore.Blazorï¼Œé¿å…å¾ªç¯ä¾èµ–
// using PaperBellStore.Blazor;

namespace ProjectManagement.Blazor;

// âš ï¸ å…³é”®ï¼šä¸ä¾èµ– PaperBellStoreBlazorModuleï¼Œé¿å…å¾ªç¯ä¾èµ–ï¼
// æ¨¡å—é€šè¿‡ DependsOn æ¥å£°æ˜ä¾èµ–å…³ç³»ï¼Œä¸»é¡¹ç›®ä¼šåŠ è½½æ­¤æ¨¡å—
[DependsOn(
    typeof(ProjectManagementApplicationModule),
    typeof(ProjectManagementApplicationContractsModule)
    // ä¸ä¾èµ–ä¸»é¡¹ç›®çš„ Blazor æ¨¡å—ï¼
)]
public class ProjectManagementBlazorModule : AbpModule
{
    public override void ConfigureServices(ServiceConfigurationContext context)
    {
        Configure<AbpNavigationOptions>(options =>
        {
            options.MenuContributors.Add(new ProjectManagementMenuContributor());
        });
    }
}
```

### 7.2 åˆ›å»ºèœå•è´¡çŒ®è€…

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Blazor/Menus/ProjectManagementMenuContributor.cs`

```csharp
using System.Threading.Tasks;
using ProjectManagement.Localization;
using ProjectManagement.Permissions;
using Volo.Abp.UI.Navigation;

namespace ProjectManagement.Blazor.Menus;

public class ProjectManagementMenuContributor : IMenuContributor
{
    public async Task ConfigureMenuAsync(MenuConfigurationContext context)
    {
        if (context.Menu.Name == StandardMenus.Main)
        {
            await ConfigureMainMenuAsync(context);
        }
    }

    private Task ConfigureMainMenuAsync(MenuConfigurationContext context)
    {
        var l = context.GetLocalizer<ProjectManagementResource>();

        context.Menu.AddItem(
            new ApplicationMenuItem(
                "ProjectManagement",
                l["Menu:ProjectManagement"],
                "/projects",
                icon: "fas fa-project-diagram",
                order: 2,
                requiredPermissionName: ProjectManagementPermissions.Default
            )
        );

        return Task.CompletedTask;
    }
}
```

### 7.3 åˆ›å»ºé¡µé¢

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Blazor/Pages/Projects/Index.razor`

ï¼ˆé¡µé¢ä»£ç ä¸ä¹‹å‰æ–‡æ¡£ä¸­çš„ç›¸åŒï¼Œè¿™é‡Œçœç•¥ï¼‰

### 7.4 åˆ›å»ºç»„ä»¶åŸºç±»

**æ–‡ä»¶ä½ç½®**: `src/ProjectManagement.Blazor/ProjectManagementComponentBase.cs`

```csharp
using ProjectManagement.Localization;
using Volo.Abp.AspNetCore.Components.Web.Theming;

namespace ProjectManagement.Blazor;

public abstract class ProjectManagementComponentBase : AbpComponentBase
{
    protected ProjectManagementComponentBase()
    {
        LocalizationResource = typeof(ProjectManagementResource);
    }
}
```

---

## ç¬¬å…«æ­¥ï¼šåœ¨ä¸»é¡¹ç›®ä¸­å¼•ç”¨æ¨¡å—

### 8.1 æ·»åŠ é¡¹ç›®å¼•ç”¨åˆ°è§£å†³æ–¹æ¡ˆ

ä¿®æ”¹ `PaperBellStore.sln`ï¼Œæ·»åŠ æ¨¡å—é¡¹ç›®ï¼š

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼Œæ¨èï¼‰**ï¼š

```xml
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.Domain.Shared", "modules\ProjectManagement\ProjectManagement.Domain.Shared\ProjectManagement.Domain.Shared.csproj", "{GUID1}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.Domain", "modules\ProjectManagement\ProjectManagement.Domain\ProjectManagement.Domain.csproj", "{GUID2}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.Application.Contracts", "modules\ProjectManagement\ProjectManagement.Application.Contracts\ProjectManagement.Application.Contracts.csproj", "{GUID3}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.Application", "modules\ProjectManagement\ProjectManagement.Application\ProjectManagement.Application.csproj", "{GUID4}"
EndProject
Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.EntityFrameworkCore", "modules\ProjectManagement\ProjectManagement.EntityFrameworkCore\ProjectManagement.EntityFrameworkCore.csproj", "{GUID5}"
EndProject
<!-- å¦‚æœé‡‡ç”¨æ–¹æ¡ˆBï¼Œæ·»åŠ  Blazor é¡¹ç›® -->
<!-- Project("{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}") = "ProjectManagement.Blazor", "modules\ProjectManagement\ProjectManagement.Blazor\ProjectManagement.Blazor.csproj", "{GUID6}"
EndProject -->

<!-- å¯é€‰ï¼šåœ¨è§£å†³æ–¹æ¡ˆä¸­æ·»åŠ  modules æ–‡ä»¶å¤¹ç»„ -->
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "modules", "modules", "{MODULES-GUID}"
EndProject
```

å¹¶åœ¨ `GlobalSection(NestedProjects)` ä¸­æ·»åŠ ï¼š

```xml
{MODULES-GUID} = {SOLUTION-GUID}
{GUID1} = {MODULES-GUID}
{GUID2} = {MODULES-GUID}
{GUID3} = {MODULES-GUID}
{GUID4} = {MODULES-GUID}
{GUID5} = {MODULES-GUID}
```

### 8.2 åœ¨ä¸»é¡¹ç›®ä¸­æ·»åŠ æ¨¡å—ä¾èµ–

#### å¦‚æœé‡‡ç”¨æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼š

åªéœ€åœ¨ä¸»é¡¹ç›®çš„ Blazor æ¨¡å—ä¸­ä¾èµ–æ¨¡å—çš„åº”ç”¨å±‚ï¼š

**ä¿®æ”¹**: `src/PaperBellStore.Blazor/PaperBellStoreBlazorModule.cs`

```csharp
using ProjectManagement.Application;  // æ·»åŠ è¿™è¡Œ

[DependsOn(
    typeof(PaperBellStoreApplicationModule),
    // ... å…¶ä»–ä¾èµ– ...
    typeof(ProjectManagementApplicationModule)  // æ·»åŠ è¿™è¡Œï¼ˆä¸æ˜¯ BlazorModuleï¼ï¼‰
)]
public class PaperBellStoreBlazorModule : AbpModule
{
    // ...
}
```

**æ·»åŠ é¡¹ç›®å¼•ç”¨**: åœ¨ `PaperBellStore.Blazor.csproj` ä¸­ï¼š

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<ItemGroup>
  <!-- å…¶ä»–å¼•ç”¨ -->
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManagement.Application\ProjectManagement.Application.csproj" />
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManagement.Application.Contracts\ProjectManagement.Application.Contracts.csproj" />
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManage.Domain.Shared\ProjectManage.Domain.Shared.csproj" />
</ItemGroup>
```

**æ·»åŠ é¡¹ç›®å¼•ç”¨**: åœ¨ `PaperBellStore.Domain.csproj` ä¸­ï¼š

**ä¿®æ”¹**: `src/PaperBellStore.Domain/PaperBellStoreDomainModule.cs`

```csharp
using ProjectManage.Domain;  // æ·»åŠ è¿™è¡Œ

[DependsOn(
    // ... å…¶ä»–ä¾èµ– ...
    typeof(ProjectManageDomainModule)  // æ·»åŠ è¿™è¡Œ
)]
public class PaperBellStoreDomainModule : AbpModule
{
    // ...
}
```

**æ–¹æ¡ˆ ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<ItemGroup>
  <!-- å…¶ä»–å¼•ç”¨ -->
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManage.Domain\ProjectManage.Domain.csproj" />
</ItemGroup>


```

#### å¦‚æœé‡‡ç”¨æ–¹æ¡ˆ Bï¼ˆç‹¬ç«‹ Blazor æ¨¡å—ï¼‰ï¼š

éœ€è¦ä¾èµ–æ¨¡å—çš„ Blazor æ¨¡å—ï¼š

**ä¿®æ”¹**: `src/PaperBellStore.Blazor/PaperBellStoreBlazorModule.cs`

```csharp
using ProjectManagement.Blazor;

[DependsOn(
    typeof(PaperBellStoreApplicationModule),
    // ... å…¶ä»–ä¾èµ– ...
    typeof(ProjectManagementBlazorModule)  // æ·»åŠ è¿™è¡Œ
)]
public class PaperBellStoreBlazorModule : AbpModule
{
    // ...
}
```

**æ³¨æ„**ï¼šæ­¤æ—¶ä¸»é¡¹ç›®çš„ Blazor é¡¹ç›®åº”è¯¥å¼•ç”¨æ¨¡å—çš„ Blazor é¡¹ç›®ï¼ˆä½œä¸ºç»„ä»¶åº“ï¼‰ï¼Œä½†ä¸åº”è¯¥å½¢æˆå¾ªç¯ä¾èµ–ã€‚

**ä¿®æ”¹**: `src/PaperBellStore.EntityFrameworkCore/EntityFrameworkCore/PaperBellStoreEntityFrameworkCoreModule.cs`

```csharp
using ProjectManagement.EntityFrameworkCore;

[DependsOn(
    typeof(PaperBellStoreDomainModule),
    // ... å…¶ä»–ä¾èµ– ...
    typeof(ProjectManagementEntityFrameworkCoreModule)  // æ·»åŠ è¿™è¡Œ
)]
public class PaperBellStoreEntityFrameworkCoreModule : AbpModule
{
    // ...
}
```

åŒæ—¶ï¼Œä¸ºè§£æ `DependsOn(typeof(ProjectManagementEntityFrameworkCoreModule))`ï¼Œéœ€è¦åœ¨ä¸»é¡¹ç›®çš„ EFCore é¡¹ç›®ä¸­æ·»åŠ å¯¹æ¨¡å— EFCore é¡¹ç›®çš„é¡¹ç›®å¼•ç”¨ï¼š

**æ–¹æ¡ˆ 1ï¼ˆæ¨¡å—åœ¨ src ç›®å½•ä¸‹ï¼‰**ï¼š

```xml
<ItemGroup>
  <ProjectReference Include="..\ProjectManagement.EntityFrameworkCore\ProjectManagement.EntityFrameworkCore.csproj" />
</ItemGroup>
```

**æ–¹æ¡ˆ 2ï¼ˆæ¨¡å—åœ¨ modules ç›®å½•ä¸‹ï¼Œæ¨èï¼‰**ï¼š

```xml
<ItemGroup>
  <ProjectReference Include="..\..\modules\ProjectManagement\ProjectManagement.EntityFrameworkCore\ProjectManagement.EntityFrameworkCore.csproj" />
</ItemGroup>
```

### 8.3 åœ¨ä¸»é¡¹ç›®çš„ DbContext ä¸­æ·»åŠ å®ä½“æ˜ å°„

**ä¿®æ”¹**: `src/PaperBellStore.EntityFrameworkCore/EntityFrameworkCore/PaperBellStoreDbContext.cs`

```csharp
using ProjectManagement.Projects;

public class PaperBellStoreDbContext : AbpDbContext<PaperBellStoreDbContext>
{
    // æ·»åŠ é¡¹ç›®ç®¡ç†å®ä½“
    public DbSet<Project> Projects { get; set; }

    protected override void OnModelCreating(ModelBuilder builder)
    {
        base.OnModelCreating(builder);

        // ... ç°æœ‰é…ç½® ...

        // é…ç½®é¡¹ç›®ç®¡ç†å®ä½“
        builder.Entity<Project>(b =>
        {
            b.ToTable(ProjectManagementConsts.DbTablePrefix + "Projects", ProjectManagementConsts.DbSchema);
            b.ConfigureByConvention();
            b.Property(x => x.Name).IsRequired().HasMaxLength(128);
            b.Property(x => x.Description).HasMaxLength(2048);
            b.HasIndex(x => x.Name);
        });
    }
}
```

### 8.4 UI ç›¸å…³é…ç½®

#### å¦‚æœé‡‡ç”¨æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼š

- âœ… åœ¨ä¸»é¡¹ç›®çš„ Blazor é¡¹ç›®ä¸­åˆ›å»ºé¡µé¢ï¼ˆè§ç¬¬ä¸ƒæ­¥æ–¹æ¡ˆ Aï¼‰
- âœ… åœ¨ä¸»é¡¹ç›®çš„èœå•è´¡çŒ®è€…ä¸­æ·»åŠ èœå•é¡¹ï¼ˆè§ç¬¬ä¸ƒæ­¥æ–¹æ¡ˆ Aï¼‰
- âœ… æ— éœ€é¢å¤–é…ç½®è·¯ç”±ï¼Œé¡µé¢ä¼šåœ¨ä¸»åº”ç”¨ä¸­æ­£å¸¸è¿è¡Œ
- âœ… ä¸»é¡¹ç›®çš„ Blazor æ¨¡å—åªéœ€ä¾èµ– `ProjectManagementApplicationModule`

#### å¦‚æœé‡‡ç”¨æ–¹æ¡ˆ Bï¼ˆç‹¬ç«‹ Blazor æ¨¡å—ï¼‰ï¼š

- âš ï¸ ç¡®ä¿ä¸»é¡¹ç›®çš„ Blazor é¡¹ç›®**ä¸ç›´æ¥å¼•ç”¨**æ¨¡å—çš„ Blazor é¡¹ç›®
- âœ… é€šè¿‡æ¨¡å—ä¾èµ–å…³ç³»ï¼ˆDependsOnï¼‰æ¥åŠ è½½æ¨¡å—
- âœ… å¯èƒ½éœ€è¦é…ç½®è·¯ç”±å‘ç°æœºåˆ¶ï¼Œç¡®ä¿é¡µé¢å¯ä»¥æ­£ç¡®è®¿é—®

---

## ç¬¬ä¹æ­¥ï¼šæ•°æ®åº“è¿ç§»

### 9.1 ç”Ÿæˆè¿ç§»

åœ¨è§£å†³æ–¹æ¡ˆï¼ˆæ ¹ï¼‰ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼š

```bash
dotnet ef migrations add "Added_ProjectManagement_Module" --project src/PaperBellStore.EntityFrameworkCore --startup-project src/PaperBellStore.DbMigrator --context PaperBellStoreDbContext
```

**æ³¨æ„**ï¼šå¦‚æœé¡¹ç›®ä¸­æœ‰å¤šä¸ª DbContextï¼Œå¿…é¡»ä½¿ç”¨ `--context` å‚æ•°æŒ‡å®šè¦ä½¿ç”¨çš„ DbContext åç§°ã€‚ä¸»é¡¹ç›®çš„ DbContext é€šå¸¸æ˜¯ `PaperBellStoreDbContext`ã€‚

### 9.2 åº”ç”¨è¿ç§»

```bash
dotnet run --project src/PaperBellStore.DbMigrator
```

---

## ç¬¬åæ­¥ï¼šé…ç½®æœ¬åœ°åŒ–èµ„æº

åœ¨ä¸»é¡¹ç›®çš„æœ¬åœ°åŒ–èµ„æºé…ç½®ä¸­æ·»åŠ æ¨¡å—çš„èµ„æºï¼š

**ä¿®æ”¹**: `src/PaperBellStore.Blazor/PaperBellStoreBlazorModule.cs`

```csharp
public override void PreConfigureServices(ServiceConfigurationContext context)
{
    context.Services.PreConfigure<AbpMvcDataAnnotationsLocalizationOptions>(options =>
    {
        options.AddAssemblyResource(
            typeof(PaperBellStoreResource),
            typeof(PaperBellStoreDomainModule).Assembly,
            typeof(PaperBellStoreDomainSharedModule).Assembly,
            typeof(PaperBellStoreApplicationModule).Assembly,
            typeof(PaperBellStoreApplicationContractsModule).Assembly,
            typeof(PaperBellStoreBlazorModule).Assembly,
            typeof(ProjectManagementResource).Assembly,  // æ·»åŠ è¡Œ
             typeof(ProjectManageDomainSharedModule).Assembly //æ·»åŠ è¡Œ
        );
    });
}
```

**ä¿®æ”¹**: `src/PaperBellStore.Blazor/PaperBellStoreBlazorModule.cs`

```csharp
  private void ConfigureVirtualFileSystem(IWebHostEnvironment hostingEnvironment)
  {
      if (hostingEnvironment.IsDevelopment())
      {
          Configure<AbpVirtualFileSystemOptions>(options =>
          {
              options.FileSets.ReplaceEmbeddedByPhysical<PaperBellStoreDomainSharedModule>(Path.Combine(hostingEnvironment.ContentRootPath, $"..{Path.DirectorySeparatorChar}PaperBellStore.Domain.Shared"));
              options.FileSets.ReplaceEmbeddedByPhysical<PaperBellStoreDomainModule>(Path.Combine(hostingEnvironment.ContentRootPath, $"..{Path.DirectorySeparatorChar}PaperBellStore.Domain"));
              options.FileSets.ReplaceEmbeddedByPhysical<PaperBellStoreApplicationContractsModule>(Path.Combine(hostingEnvironment.ContentRootPath, $"..{Path.DirectorySeparatorChar}PaperBellStore.Application.Contracts"));
              options.FileSets.ReplaceEmbeddedByPhysical<PaperBellStoreApplicationModule>(Path.Combine(hostingEnvironment.ContentRootPath, $"..{Path.DirectorySeparatorChar}PaperBellStore.Application"));
              options.FileSets.ReplaceEmbeddedByPhysical<PaperBellStoreBlazorModule>(hostingEnvironment.ContentRootPath);
              // æ·»åŠ å­æ¨¡å—çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿé…ç½®
              options.FileSets.ReplaceEmbeddedByPhysical<ProjectManageDomainSharedModule>(Path.Combine(hostingEnvironment.ContentRootPath, $"..{Path.DirectorySeparatorChar}..{Path.DirectorySeparatorChar}modules{Path.DirectorySeparatorChar}ProjectManagement{Path.DirectorySeparatorChar}ProjectManage.Domain.Shared")); //æ·»åŠ è¡Œ
          });
      }
  }
```

**ä¿®æ”¹**: `src/PaperBellStore.Blazor/Menus/PaperBellStoreMenuContributor.cs`

```csharp
 private Task ConfigureMainMenuAsync(MenuConfigurationContext context)
 {
     var l = context.GetLocalizer<PaperBellStoreResource>();
     var projectL = context.GetLocalizer<ProjectManageResource>(); //æ·»åŠ è¡Œ

     context.Menu.Items.Insert(
         0 ,
         new ApplicationMenuItem(
             PaperBellStoreMenus.Home ,
             l["Menu:Home"] ,
             "/" ,
             icon: "fas fa-home" ,
             order: 1
         )
     );

     context.Menu.Items.Insert(
         1 ,
         new ApplicationMenuItem(
             "ProjectManagement" ,
             projectL["Menu:ProjectManagement"] , //ä¿®æ”¹è¡Œ
             "/projects" ,
             icon: "fas fa-project-diagram" ,
             order: 2
         )
     );

     //Administration
     var administration = context.Menu.GetAdministration();
     administration.Order=6;

     if(MultiTenancyConsts.IsEnabled)
     {
         administration.SetSubItemOrder(TenantManagementMenuNames.GroupName , 1);
     }
     else
     {
         administration.TryRemoveMenuItem(TenantManagementMenuNames.GroupName);
     }

     administration.SetSubItemOrder(IdentityMenuNames.GroupName , 2);
     administration.SetSubItemOrder(SettingManagementMenus.GroupName , 3);

     return Task.CompletedTask;
 }
```

---

## âœ… æ£€æŸ¥æ¸…å•

- [ ] 1. åˆ›å»ºæ‰€æœ‰æ¨¡å—é¡¹ç›®æ–‡ä»¶
- [ ] 2. æ·»åŠ é¡¹ç›®åˆ°è§£å†³æ–¹æ¡ˆ
- [ ] 3. é…ç½®å„å±‚æ¨¡å—ä¾èµ–å…³ç³»
- [ ] 4. åœ¨ä¸»é¡¹ç›®ä¸­æ·»åŠ æ¨¡å—ä¾èµ–
- [ ] 5. åœ¨ä¸»é¡¹ç›® DbContext ä¸­é…ç½®å®ä½“
- [ ] 6. ç”Ÿæˆå¹¶è¿è¡Œæ•°æ®åº“è¿ç§»
- [ ] 7. é…ç½®æœ¬åœ°åŒ–èµ„æº
- [ ] 8. æµ‹è¯•æ¨¡å—åŠŸèƒ½

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **DbContext å…±äº«**: æ¨¡å—ä½¿ç”¨ä¸»é¡¹ç›®çš„ DbContextï¼Œæ‰€ä»¥å®ä½“æ˜ å°„éœ€è¦åœ¨ä¸»é¡¹ç›®ä¸­é…ç½®ï¼ˆè¿™æ˜¯å”¯ä¸€éœ€è¦ä¿®æ”¹ä¸»é¡¹ç›®çš„åœ°æ–¹ï¼‰
2. **å‘½åç©ºé—´**: ç¡®ä¿æ¨¡å—çš„å‘½åç©ºé—´ç‹¬ç«‹ï¼Œé¿å…å†²çª
3. **è¡¨å‰ç¼€**: ä½¿ç”¨ `ProjectManagementConsts.DbTablePrefix` ç¡®ä¿è¡¨åä¸å†²çª
4. **ä¾èµ–æ–¹å‘**: æ¨¡å—ä¾èµ–ä¸»é¡¹ç›®ï¼Œä¸»é¡¹ç›®å¼•ç”¨æ¨¡å—ï¼Œå½¢æˆæ¨¡å—åŒ–æ¶æ„

---

## ğŸ¯ ä¼˜åŠ¿æ€»ç»“

é‡‡ç”¨æ¨¡å—åŒ–å¼€å‘æ–¹å¼çš„å¥½å¤„ï¼š

- âœ… åŸºç¡€é¡¹ç›®ä»£ç ä¿æŒå¹²å‡€
- âœ… æ¨¡å—åŠŸèƒ½ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•
- âœ… æ˜“äºç‰ˆæœ¬ç®¡ç†å’Œå‡çº§
- âœ… å¯ä»¥åœ¨å¤šä¸ªé¡¹ç›®ä¸­å¤ç”¨æ¨¡å—
- âœ… å›¢é˜Ÿæˆå‘˜å¯ä»¥å¹¶è¡Œå¼€å‘ä¸åŒæ¨¡å—
