# 项目管理模块实施步骤

本文档详细说明如何在基于 ABP 框架的 Blazor Server 项目中添加一个定制的项目管理模块。

## 项目架构概览

本项目采用 ABP 框架的经典分层架构：

- **Domain.Shared**: 共享常量、枚举、DTO 接口
- **Domain**: 实体、领域服务和仓储接口
- **Application.Contracts**: DTO、接口和服务契约
- **Application**: 应用服务实现
- **EntityFrameworkCore**: 数据库上下文和仓储实现
- **Blazor**: UI 界面（Blazor Server）

---

## 实施步骤

### 第一步：领域共享层 (Domain.Shared)

#### 1.1 创建权限常量定义

**文件位置**: `src/PaperBellStore.Application.Contracts/Permissions/PaperBellStorePermissions.cs`

在现有文件末尾添加项目管理权限类（或创建新文件 `ProjectManagementPermissions.cs`）：

**选项 1：在同一文件中添加**

```csharp
// 在文件末尾添加
public static class ProjectManagementPermissions
{
    // ... 权限常量
}
```

**选项 2：创建新文件**（推荐）
**文件位置**: `src/PaperBellStore.Application.Contracts/Permissions/ProjectManagementPermissions.cs`

添加项目管理相关的权限常量：

```csharp
public static class ProjectManagementPermissions
{
    public const string GroupName = "ProjectManagement";

    public const string Default = GroupName;
    public const string Create = Default + ".Create";
    public const string Edit = Default + ".Edit";
    public const string Delete = Default + ".Delete";
    public const string View = Default + ".View";
}
```

#### 1.2 更新菜单常量

**文件位置**: `src/PaperBellStore.Blazor/Menus/PaperBellStoreMenus.cs`

在现有文件中添加项目管理菜单常量：

```csharp
namespace PaperBellStore.Blazor.Menus;

public class PaperBellStoreMenus
{
    private const string Prefix = "PaperBellStore";
    public const string Home = Prefix + ".Home";

    // 添加项目管理菜单
    public const string ProjectManagement = Prefix + ".ProjectManagement";
}
```

#### 1.3 添加本地化资源

**文件位置**: `src/PaperBellStore.Domain.Shared/Localization/PaperBellStore/zh-Hans.json`

在本地化文件中添加项目管理相关的翻译：

```json
{
  "culture": "zh-Hans",
  "texts": {
    "Menu:ProjectManagement": "项目管理",
    "Permission:ProjectManagement": "项目管理",
    "Permission:ProjectManagement.Create": "创建项目",
    "Permission:ProjectManagement.Edit": "编辑项目",
    "Permission:ProjectManagement.Delete": "删除项目",
    "Permission:ProjectManagement.View": "查看项目"
  }
}
```

---

### 第二步：领域层 (Domain)

#### 2.1 创建项目实体

**文件位置**: `src/PaperBellStore.Domain/Projects/Project.cs`

```csharp
using System;
using Volo.Abp.Domain.Entities.Auditing;
using Volo.Abp.MultiTenancy;

namespace PaperBellStore.Projects;

public class Project : FullAuditedAggregateRoot<Guid>, IMultiTenant
{
    public string Name { get; set; }
    public string Description { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime? EndDate { get; set; }
    public ProjectStatus Status { get; set; }
    public Guid? OwnerId { get; set; } // 项目经理ID，关联到IdentityUser
    public Guid? TenantId { get; set; } // 多租户支持

    protected Project()
    {
    }

    public Project(Guid id, string name, string description = null)
        : base(id)
    {
        Name = name;
        Description = description;
        Status = ProjectStatus.Planning;
    }
}
```

#### 2.2 创建枚举

**文件位置**: `src/PaperBellStore.Domain/Projects/ProjectStatus.cs`

```csharp
namespace PaperBellStore.Projects;

public enum ProjectStatus
{
    Planning = 0,
    InProgress = 1,
    OnHold = 2,
    Completed = 3,
    Cancelled = 4
}
```

#### 2.3 创建仓储接口

**文件位置**: `src/PaperBellStore.Domain/Projects/IProjectRepository.cs`

```csharp
using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using Volo.Abp.Domain.Repositories;

namespace PaperBellStore.Projects;

public interface IProjectRepository : IRepository<Project, Guid>
{
    Task<List<Project>> GetListAsync(
        string sorting = null,
        int maxResultCount = int.MaxValue,
        int skipCount = 0,
        string filter = null,
        CancellationToken cancellationToken = default);

    Task<long> GetCountAsync(
        string filter = null,
        CancellationToken cancellationToken = default);
}
```

---

### 第三步：应用服务契约层 (Application.Contracts)

#### 3.1 创建 DTO

**文件位置**: `src/PaperBellStore.Application.Contracts/Projects/ProjectDto.cs`

```csharp
using System;
using Volo.Abp.Application.Dtos;

namespace PaperBellStore.Projects;

public class ProjectDto : FullAuditedEntityDto<Guid>
{
    public string Name { get; set; }
    public string Description { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime? EndDate { get; set; }
    public ProjectStatus Status { get; set; }
    public Guid? OwnerId { get; set; }
    public string OwnerName { get; set; }
}
```

#### 3.2 创建创建/更新 DTO

**文件位置**: `src/PaperBellStore.Application.Contracts/Projects/CreateUpdateProjectDto.cs`

```csharp
using System;
using System.ComponentModel.DataAnnotations;

namespace PaperBellStore.Projects;

public class CreateUpdateProjectDto
{
    [Required]
    [StringLength(128)]
    public string Name { get; set; }

    [StringLength(2048)]
    public string Description { get; set; }

    [Required]
    public DateTime StartDate { get; set; }

    public DateTime? EndDate { get; set; }

    public ProjectStatus Status { get; set; } = ProjectStatus.Planning;

    public Guid? OwnerId { get; set; }
}
```

#### 3.3 创建查询 DTO

**文件位置**: `src/PaperBellStore.Application.Contracts/Projects/GetProjectListDto.cs`

```csharp
using System;
using Volo.Abp.Application.Dtos;

namespace PaperBellStore.Projects;

public class GetProjectListDto : PagedAndSortedResultRequestDto
{
    public string Filter { get; set; }
    public ProjectStatus? Status { get; set; }
}
```

#### 3.4 创建应用服务接口

**文件位置**: `src/PaperBellStore.Application.Contracts/Projects/IProjectAppService.cs`

```csharp
using System;
using System.Threading.Tasks;
using Volo.Abp.Application.Dtos;
using Volo.Abp.Application.Services;

namespace PaperBellStore.Projects;

public interface IProjectAppService :
    ICrudAppService<
        ProjectDto,
        Guid,
        GetProjectListDto,
        CreateUpdateProjectDto,
        CreateUpdateProjectDto>
{
}
```

---

### 第四步：应用层 (Application)

#### 4.1 创建应用服务实现

**文件位置**: `src/PaperBellStore.Application/Projects/ProjectAppService.cs`

```csharp
using System;
using System.Linq;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Authorization;
using PaperBellStore.Permissions;
using PaperBellStore.Projects;
using Volo.Abp.Application.Dtos;
using Volo.Abp.Application.Services;
using Volo.Abp.Domain.Repositories;
using Volo.Abp.Identity;

namespace PaperBellStore.Projects;

[Authorize(ProjectManagementPermissions.Default)]
public class ProjectAppService :
    CrudAppService<
        Project,
        ProjectDto,
        Guid,
        GetProjectListDto,
        CreateUpdateProjectDto,
        CreateUpdateProjectDto>,
    IProjectAppService
{
    private readonly IIdentityUserRepository _userRepository;

    public ProjectAppService(
        IRepository<Project, Guid> repository,
        IIdentityUserRepository userRepository)
        : base(repository)
    {
        _userRepository = userRepository;
        GetPolicyName = ProjectManagementPermissions.View;
        GetListPolicyName = ProjectManagementPermissions.View;
        CreatePolicyName = ProjectManagementPermissions.Create;
        UpdatePolicyName = ProjectManagementPermissions.Edit;
        DeletePolicyName = ProjectManagementPermissions.Delete;
    }

    protected override async Task<ProjectDto> MapToGetOutputDtoAsync(Project entity)
    {
        var dto = await base.MapToGetOutputDtoAsync(entity);

        if (entity.OwnerId.HasValue)
        {
            var owner = await _userRepository.GetAsync(entity.OwnerId.Value);
            dto.OwnerName = owner.UserName;
        }

        return dto;
    }

    protected override async Task<IQueryable<Project>> CreateFilteredQueryAsync(GetProjectListDto input)
    {
        var queryable = await base.CreateFilteredQueryAsync(input);

        if (!string.IsNullOrWhiteSpace(input.Filter))
        {
            queryable = queryable.Where(x =>
                x.Name.Contains(input.Filter) ||
                (x.Description != null && x.Description.Contains(input.Filter)));
        }

        if (input.Status.HasValue)
        {
            queryable = queryable.Where(x => x.Status == input.Status.Value);
        }

        return queryable;
    }
}
```

#### 4.2 配置 AutoMapper

**文件位置**: `src/PaperBellStore.Application/PaperBellStoreApplicationAutoMapperProfile.cs`

```csharp
using PaperBellStore.Projects;
using AutoMapper;

namespace PaperBellStore;

public class PaperBellStoreApplicationAutoMapperProfile : Profile
{
    public PaperBellStoreApplicationAutoMapperProfile()
    {
        // 项目管理的映射配置
        CreateMap<Project, ProjectDto>();
        CreateMap<CreateUpdateProjectDto, Project>();
    }
}
```

---

### 第五步：EntityFrameworkCore 层

#### 5.1 实现仓储

**文件位置**: `src/PaperBellStore.EntityFrameworkCore/Projects/ProjectRepository.cs`

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Dynamic.Core;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.EntityFrameworkCore;
using PaperBellStore.Projects;
using Volo.Abp.Domain.Repositories.EntityFrameworkCore;
using Volo.Abp.EntityFrameworkCore;

namespace PaperBellStore.EntityFrameworkCore.Projects;

public class ProjectRepository :
    EfCoreRepository<PaperBellStoreDbContext, Project, Guid>,
    IProjectRepository
{
    public ProjectRepository(
        IDbContextProvider<PaperBellStoreDbContext> dbContextProvider)
        : base(dbContextProvider)
    {
    }

    public async Task<List<Project>> GetListAsync(
        string sorting = null,
        int maxResultCount = int.MaxValue,
        int skipCount = 0,
        string filter = null,
        CancellationToken cancellationToken = default)
    {
        var query = await GetQueryableAsync();

        if (!string.IsNullOrWhiteSpace(filter))
        {
            query = query.Where(x =>
                x.Name.Contains(filter) ||
                (x.Description != null && x.Description.Contains(filter)));
        }

        query = string.IsNullOrWhiteSpace(sorting)
            ? query.OrderByDescending(x => x.CreationTime)
            : query.OrderBy(sorting);

        return await query
            .Skip(skipCount)
            .Take(maxResultCount)
            .ToListAsync(cancellationToken);
    }

    public async Task<long> GetCountAsync(
        string filter = null,
        CancellationToken cancellationToken = default)
    {
        var query = await GetQueryableAsync();

        if (!string.IsNullOrWhiteSpace(filter))
        {
            query = query.Where(x =>
                x.Name.Contains(filter) ||
                (x.Description != null && x.Description.Contains(filter)));
        }

        return await query.LongCountAsync(cancellationToken);
    }
}
```

#### 5.2 配置 DbContext

**文件位置**: `src/PaperBellStore.EntityFrameworkCore/EntityFrameworkCore/PaperBellStoreDbContext.cs`

添加 DbSet 属性：

```csharp
public DbSet<Project> Projects { get; set; }
```

在 `OnModelCreating` 方法中配置实体：

```csharp
builder.Entity<Project>(b =>
{
    b.ToTable(PaperBellStoreConsts.DbTablePrefix + "Projects", PaperBellStoreConsts.DbSchema);
    b.ConfigureByConvention();

    b.Property(x => x.Name).IsRequired().HasMaxLength(128);
    b.Property(x => x.Description).HasMaxLength(2048);

    b.HasIndex(x => x.Name);
});
```

#### 5.3 注册仓储实现

**文件位置**: `src/PaperBellStore.EntityFrameworkCore/EntityFrameworkCore/PaperBellStoreEntityFrameworkCoreModule.cs`

在 `ConfigureServices` 方法中添加：

```csharp
using PaperBellStore.Projects;
using PaperBellStore.EntityFrameworkCore.Projects;

public override void ConfigureServices(ServiceConfigurationContext context)
{
    // ... 其他配置

    context.Services.AddAbpDbContext<PaperBellStoreDbContext>(options =>
    {
        // ... 其他仓储注册
        options.AddRepository<Project, ProjectRepository>();
    });
}
```

---

### 第六步：创建数据库迁移

#### 6.1 生成迁移

在项目根目录运行：

```bash
dotnet ef migrations add "Added_Project_Entity" --project src/PaperBellStore.EntityFrameworkCore --startup-project src/PaperBellStore.DbMigrator
```

#### 6.2 更新数据库

```bash
dotnet run --project src/PaperBellStore.DbMigrator
```

---

### 第七步：权限配置

#### 7.1 更新权限定义提供程序

**文件位置**: `src/PaperBellStore.Application.Contracts/Permissions/PaperBellStorePermissionDefinitionProvider.cs`

在 `Define` 方法中添加项目管理权限定义（如果`ProjectManagementPermissions`在单独文件中，需要添加相应的 using 语句）：

```csharp
public override void Define(IPermissionDefinitionContext context)
{
    var myGroup = context.AddGroup(PaperBellStorePermissions.GroupName);

    // 添加项目管理权限组
    var projectManagementGroup = context.AddGroup(
        ProjectManagementPermissions.GroupName,
        L("Permission:ProjectManagement"));

    projectManagementGroup.AddPermission(
        ProjectManagementPermissions.Default,
        L("Permission:ProjectManagement"));

    projectManagementGroup.AddPermission(
        ProjectManagementPermissions.Create,
        L("Permission:ProjectManagement.Create"));

    projectManagementGroup.AddPermission(
        ProjectManagementPermissions.Edit,
        L("Permission:ProjectManagement.Edit"));

    projectManagementGroup.AddPermission(
        ProjectManagementPermissions.Delete,
        L("Permission:ProjectManagement.Delete"));

    projectManagementGroup.AddPermission(
        ProjectManagementPermissions.View,
        L("Permission:ProjectManagement.View"));
}
```

---

### 第八步：Blazor UI 层

#### 8.1 创建项目列表页面

**文件位置**: `src/PaperBellStore.Blazor/Pages/Projects/Index.razor`

```razor
@page "/projects"
@using PaperBellStore.Projects
@using PaperBellStore.Permissions
@using Volo.Abp.Application.Dtos
@using MudBlazor
@inherits PaperBellStoreComponentBase

<PageTitle>项目管理</PageTitle>

<Card>
    <CardHeader>
        <CardTitle>项目列表</CardTitle>
        <CardSubtitle>管理您的项目</CardSubtitle>
    </CardHeader>
    <CardBody>
        <MudTextField @bind-Value="SearchText"
                     Placeholder="搜索项目..."
                     Variant="Variant.Outlined"
                     Adornment="Adornment.Start"
                     AdornmentIcon="@Icons.Material.Filled.Search"
                     Immediate="true"
                     OnKeyDown="OnSearchKeyDown"/>

        <MudButton Variant="Variant.Filled"
                  Color="Color.Primary"
                  StartIcon="@Icons.Material.Filled.Add"
                  OnClick="OpenCreateModal"
                  Style="margin-top: 10px;">
            新建项目
        </MudButton>

        <MudTable Items="@Projects"
                 Hover="true"
                 Dense="true"
                 Striped="true"
                 Loading="@IsLoading"
                 SortMode="SortMode.Multiple"
                 Style="margin-top: 10px;">
            <HeaderContent>
                <MudTh>名称</MudTh>
                <MudTh>描述</MudTh>
                <MudTh>开始日期</MudTh>
                <MudTh>状态</MudTh>
                <MudTh>操作</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="名称">@context.Name</MudTd>
                <MudTd DataLabel="描述">@context.Description</MudTd>
                <MudTd DataLabel="开始日期">@context.StartDate.ToString("yyyy-MM-dd")</MudTd>
                <MudTd DataLabel="状态">
                    <MudChip Size="Size.Small" Color="@GetStatusColor(context.Status)">
                        @context.Status.ToString()
                    </MudChip>
                </MudTd>
                <MudTd DataLabel="操作">
                    <MudButtonGroup Variant="Variant.Text" Size="Size.Small">
                        <MudButton StartIcon="@Icons.Material.Filled.Edit"
                                 OnClick="@(() => OpenEditModal(context.Id))">
                            编辑
                        </MudButton>
                        <MudButton StartIcon="@Icons.Material.Filled.Delete"
                                 Color="Color.Error"
                                 OnClick="@(() => DeleteProject(context))">
                            删除
                        </MudButton>
                    </MudButtonGroup>
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudTablePager PageSizeOptions="new int[] {10, 25, 50}"
                              InfoFormat="{first_item}-{last_item} of {all_items}"
                              PageSize="PageSize"
                              TotalItems="@TotalCount"
                              Page="@CurrentPage"
                              OnPageSizeChanged="OnPageSizeChanged"
                              OnPageChanged="OnPageChanged"/>
            </PagerContent>
        </MudTable>
    </CardBody>
</Card>

<!-- 创建/编辑对话框 -->
<MudDialog @bind-IsVisible="ShowCreateEditModal" Options="@(new DialogOptions { MaxWidth = MaxWidth.Medium, FullWidth = true })">
    <TitleContent>
        <MudText Typo="Typo.h6">@(EditingProject != null ? "编辑项目" : "新建项目")</MudText>
    </TitleContent>
    <DialogContent>
        <MudTextField @bind-Value="CreateEditProject.Name"
                     Label="项目名称"
                     Required="true"
                     Variant="Variant.Outlined"
                     FullWidth="true"
                     Margin="Margin.Normal"/>

        <MudTextField @bind-Value="CreateEditProject.Description"
                     Label="描述"
                     Lines="3"
                     Variant="Variant.Outlined"
                     FullWidth="true"
                     Margin="Margin.Normal"/>

        <MudDatePicker @bind-Date="StartDate"
                      Label="开始日期"
                      Variant="Variant.Outlined"
                      FullWidth="true"
                      Margin="Margin.Normal"/>

        <MudSelect @bind-Value="CreateEditProject.Status"
                  Label="状态"
                  Variant="Variant.Outlined"
                  FullWidth="true"
                  Margin="Margin.Normal">
            @foreach (var status in Enum.GetValues<ProjectStatus>())
            {
                <MudSelectItem Value="@status">@status.ToString()</MudSelectItem>
            }
        </MudSelect>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="CancelCreateEdit">取消</MudButton>
        <MudButton Color="Color.Primary" Variant="Variant.Filled" OnClick="SaveProject">保存</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Inject] private IProjectAppService ProjectAppService { get; set; }
    [Inject] private IDialogService DialogService { get; set; }
    [Inject] private ISnackbar Snackbar { get; set; }

    private List<ProjectDto> Projects = new();
    private bool IsLoading = false;
    private string SearchText = "";
    private int CurrentPage = 1;
    private int PageSize = 10;
    private long TotalCount = 0;

    private bool ShowCreateEditModal = false;
    private CreateUpdateProjectDto CreateEditProject = new();
    private Guid? EditingProjectId = null;
    private DateTime? StartDate;

    protected override async Task OnInitializedAsync()
    {
        await LoadProjectsAsync();
    }

    private async Task LoadProjectsAsync()
    {
        IsLoading = true;
        try
        {
            var input = new GetProjectListDto
            {
                Filter = SearchText,
                MaxResultCount = PageSize,
                SkipCount = (CurrentPage - 1) * PageSize,
                Sorting = "CreationTime DESC"
            };

            var result = await ProjectAppService.GetListAsync(input);
            Projects = result.Items.ToList();
            TotalCount = result.TotalCount;
        }
        catch (Exception ex)
        {
            await Snackbar.AddAsync($"加载项目列表失败: {ex.Message}", Severity.Error);
        }
        finally
        {
            IsLoading = false;
        }
    }

    private async Task OnSearchKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            CurrentPage = 1;
            await LoadProjectsAsync();
        }
    }

    private void OpenCreateModal()
    {
        CreateEditProject = new CreateUpdateProjectDto();
        EditingProjectId = null;
        StartDate = DateTime.Now;
        ShowCreateEditModal = true;
    }

    private async Task OpenEditModal(Guid id)
    {
        try
        {
            var project = await ProjectAppService.GetAsync(id);
            CreateEditProject = new CreateUpdateProjectDto
            {
                Name = project.Name,
                Description = project.Description,
                StartDate = project.StartDate,
                EndDate = project.EndDate,
                Status = project.Status,
                OwnerId = project.OwnerId
            };
            EditingProjectId = id;
            StartDate = project.StartDate;
            ShowCreateEditModal = true;
        }
        catch (Exception ex)
        {
            await Snackbar.AddAsync($"加载项目信息失败: {ex.Message}", Severity.Error);
        }
    }

    private async Task SaveProject()
    {
        try
        {
            if (StartDate.HasValue)
            {
                CreateEditProject.StartDate = StartDate.Value;
            }

            if (EditingProjectId.HasValue)
            {
                await ProjectAppService.UpdateAsync(EditingProjectId.Value, CreateEditProject);
                await Snackbar.AddAsync("项目更新成功", Severity.Success);
            }
            else
            {
                await ProjectAppService.CreateAsync(CreateEditProject);
                await Snackbar.AddAsync("项目创建成功", Severity.Success);
            }

            ShowCreateEditModal = false;
            await LoadProjectsAsync();
        }
        catch (Exception ex)
        {
            await Snackbar.AddAsync($"保存失败: {ex.Message}", Severity.Error);
        }
    }

    private void CancelCreateEdit()
    {
        ShowCreateEditModal = false;
    }

    private async Task DeleteProject(ProjectDto project)
    {
        var result = await DialogService.ShowMessageBox(
            "确认删除",
            $"确定要删除项目 '{project.Name}' 吗？",
            yesText: "删除",
            cancelText: "取消");

        if (result == true)
        {
            try
            {
                await ProjectAppService.DeleteAsync(project.Id);
                await Snackbar.AddAsync("项目删除成功", Severity.Success);
                await LoadProjectsAsync();
            }
            catch (Exception ex)
            {
                await Snackbar.AddAsync($"删除失败: {ex.Message}", Severity.Error);
            }
        }
    }

    private async Task OnPageChanged(int page)
    {
        CurrentPage = page;
        await LoadProjectsAsync();
    }

    private async Task OnPageSizeChanged(int pageSize)
    {
        PageSize = pageSize;
        CurrentPage = 1;
        await LoadProjectsAsync();
    }

    private Color GetStatusColor(ProjectStatus status)
    {
        return status switch
        {
            ProjectStatus.Planning => Color.Info,
            ProjectStatus.InProgress => Color.Success,
            ProjectStatus.OnHold => Color.Warning,
            ProjectStatus.Completed => Color.Primary,
            ProjectStatus.Cancelled => Color.Error,
            _ => Color.Default
        };
    }
}
```

#### 8.2 更新菜单

**文件位置**: `src/PaperBellStore.Blazor/Menus/PaperBellStoreMenuContributor.cs`

在 `ConfigureMainMenuAsync` 方法中添加项目管理菜单项：

```csharp
using PaperBellStore.Blazor.Menus;
using PaperBellStore.Permissions;

// ... 其他using语句

private Task ConfigureMainMenuAsync(MenuConfigurationContext context)
{
    var l = context.GetLocalizer<PaperBellStoreResource>();

    context.Menu.Items.Insert(
        0,
        new ApplicationMenuItem(
            PaperBellStoreMenus.Home,
            l["Menu:Home"],
            "/",
            icon: "fas fa-home",
            order: 1
        )
    );

    // 添加项目管理菜单
    context.Menu.AddItem(
        new ApplicationMenuItem(
            PaperBellStoreMenus.ProjectManagement,
            l["Menu:ProjectManagement"],
            "/projects",
            icon: "fas fa-project-diagram",
            order: 2,
            requiredPermissionName: ProjectManagementPermissions.Default
        )
    );

    // ... 其他代码保持不变
}
```

---

## 实施检查清单

- [ ] 1. 完成 Domain.Shared 层的常量定义
- [ ] 2. 完成 Domain 层的实体和仓储接口
- [ ] 3. 完成 Application.Contracts 层的 DTO 和接口
- [ ] 4. 完成 Application 层的应用服务实现
- [ ] 5. 完成 EntityFrameworkCore 层的仓储实现和 DbContext 配置
- [ ] 6. 生成并运行数据库迁移
- [ ] 7. 配置权限定义
- [ ] 8. 创建 Blazor UI 页面
- [ ] 9. 更新菜单配置
- [ ] 10. 测试 CRUD 功能
- [ ] 11. 测试权限控制
- [ ] 12. 添加必要的本地化资源

---

## 注意事项

1. **命名空间一致性**: 确保所有层的命名空间保持一致
2. **权限检查**: 在应用服务中正确配置权限策略
3. **多租户支持**: 如果启用了多租户，确保实体实现了`IMultiTenant`接口
4. **审计字段**: 实体继承`FullAuditedAggregateRoot`可自动记录创建、修改和删除信息
5. **数据库迁移**: 每次修改实体后都需要生成新的迁移
6. **本地化**: 所有用户可见的文本都应该添加到本地化资源文件中

---

## 后续扩展建议

1. 添加项目任务（Task）实体，建立项目与任务的关系
2. 添加项目成员管理
3. 添加项目文档管理
4. 添加项目时间跟踪
5. 添加项目报表和统计功能
6. 实现项目的状态流转工作流

---

## 相关资源

- [ABP 框架官方文档](https://docs.abp.io/)
- [ABP 应用服务文档](https://docs.abp.io/en/abp/latest/Application-Services)
- [Blazor 组件文档](https://blazorise.com/docs/)
